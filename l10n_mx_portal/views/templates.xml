<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="mx_assets_frontend" inherit_id="website.assets_frontend" name="MX Portal Assets">
      <xpath expr="." position="inside">
          <script type="text/javascript" src="/l10n_mx_portal/static/src/js/mx_portal_tour.js"></script>
      </xpath>
    </template>
    <template id="website_e_invoices" inherit_id="website_portal_sale.portal_my_invoices" name="Download E-invoices">
        <xpath expr="//th[last()]" position="attributes">
            <attribute name="class">col-md-3 text-right</attribute>
        </xpath>
        <xpath expr="//td[last()]" position="after">
            <t t-set="attachment_name" t-value="'%s_%s.xml' % (invoice.company_id.vat, invoice.number)"/>
            <t t-set="attachment_id" t-value="env['ir.attachment'].search([('res_id','=', invoice.id),('res_model', '=', 'account.invoice'),('name', '=', attachment_name)], limit=1)"/>
            <td>
                <div class="btn-group pull-right">
                    <a t-att-href="'/send_invoice_mail/{0}'.format(invoice.id)" t-att-class="'btn btn-xs btn-primary' if attachment_id else 'btn btn-xs btn-primary disabled'" title="Send Email"><i class="fa fa-envelope"></i></a>
                    <a t-att-href="'/web/content/{0}?download=true'.format(attachment_id.id)" t-att-class="'btn btn-xs btn-primary' if attachment_id else 'btn btn-xs btn-primary disabled'" title="Download XML" target="_blank"><i class="fa fa-download"></i></a>
                </div>
            </td>
        </xpath>
        <xpath expr="//th[6]" position="after">
            <th></th>
        </xpath>
        <xpath expr="//th[4]" position="replace">
        </xpath>
        <xpath expr="//th[4]" position="attributes">
            <attribute name="class">col-md-2</attribute>
        </xpath>
        <xpath expr="//th[5]" position="attributes">
            <attribute name="class">col-md-4 text-center</attribute>
        </xpath>
        <xpath expr="//td[4]" position="replace">
        </xpath>
        <xpath expr="//td[5]/span" position="before">
            <t t-if="invoice.state == 'open'">
                <span class="label label-info"><i class="fa fa-fw fa-clock-o"/> Not Paid</span>
            </t>
            <t t-if="invoice.state == 'paid'">
                <span class="label label-default"><i class="fa fa-fw fa-check"/> Paid</span>
            </t>
            <t t-if="invoice.state == 'cancel'">
                <span class="label label-default"><i class="fa fa-fw fa-remove"/> Cancelled</span>
            </t>
        </xpath>
        <xpath expr="//table" position="attributes">
            <attribute name="class">table table-hover</attribute>
        </xpath>
    </template>

    <template id="email_sent" name="Email Sent">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="container mb64">
                    <div class="col-md-8">
                        <div class="oe_structure">
                            <h3 class="alert alert-success">The invoice has been sent</h3>
                        </div>
                    </div>
                    <div id="o_my_sidebar" class="col-md-3 col-md-offset-1 o_my_sidebar">
                        <div class="o_my_details">
                            <h3 class="page-header">Your Details <a href="/my/home" class="btn btn-default btn-xs">Change</a></h3>
                            <div t-field="user.partner_id" t-field-options='{"widget": "contact", "fields": ["email", "phone", "address", "name"]}'/>
                        </div>
                    </div>
                    <div class="col-md-12 oe_structure"/>
                </div>
            </div>
        </t>
    </template>
</odoo>
